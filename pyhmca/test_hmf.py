#/usr/bin/python3

import hmca

n_species_0 = 3
n_species_1 = 3
n_unimol = 4
n_bimol  = 18
reactions = [
        0,1, 3,4, 1,0, 4,3,
        0,0,2,2, 3,3,5,5, 3,0,5,2, 2,2,0,0, 5,5,3,3, 5,2,3,0,
        1,0,0,1, 4,3,3,4, 1,3,0,4, 4,0,3,1,
        2,0,0,2, 5,3,3,5, 2,3,0,5, 5,0,3,2,
        1,2,0,0, 4,5,3,3, 1,5,0,3, 4,2,3,0,
        ]
mesh = 3

rates = [
        0.90, 0.70, 0.30, 0.70, 0.70, 0.10, 0.50, 0.50, 0.90, 0.20, 0.50, 0.70, 0.60, 0.70, 0.80, 0.60, 0.50, 0.20, 0.60, 0.30, 0.50, 0.60,
        0.10, 0.80, 0.60, 1.00, 0.90, 0.40, 0.90, 1.00, 0.60, 0.80, 0.90, 1.00, 0.60, 0.70, 0.10, 0.20, 0.10, 0.10, 0.40, 0.80, 0.70, 0.90,
        0.60, 0.50, 0.60, 0.20, 0.80, 0.20, 0.60, 0.20, 0.90, 0.60, 0.10, 0.40, 0.70, 0.10, 0.70, 0.60, 0.30, 0.40, 0.50, 0.10, 0.40, 0.20,
        ]
weights = [0.90, 0.60, 0.40]
y = [
        0.66, 0.59, 0.07, 0.00, 0.67, 0.00,
        0.59, 0.00, 0.00, 0.01, 0.82, 0.64,
        0.65, 0.30, 0.00, 0.25, 0.00, 0.55,
        ]

print('k =', rates)
print('y =', y)

mymf = hmca.hmf(n_species_0, n_species_1, n_unimol, n_bimol, mesh, reactions, rates, weights, hmca.hmf_nn_2x1)

dydt = mymf.func(y)
print('f =')
print(dydt)

dfdy = mymf.jac(y)
print('J =')
print(dfdy)

